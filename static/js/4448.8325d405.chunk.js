"use strict";(self.webpackChunkportfolio=self.webpackChunkportfolio||[]).push([[4448],{4448:(t,e,i)=>{i.d(e,{SoundsInstance:()=>c});var n=i(4864),s=i(3280);const o=1;function a(t){var e,i;const n=document.createElement("img"),{clickCb:s,container:a,display:u,iconOptions:c,margin:l,options:r,pos:d,rightOffsets:h}=t,{width:_,path:m,style:p,svg:v}=c;!function(t,e,i,n,s,a,u,c){t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.position="absolute",t.style.top="".concat(e+u,"px"),t.style.left="".concat(i-u-a,"px"),t.style.display=n,t.style.zIndex="".concat(s+o),t.style.cssText+=c}(n,d.top+l,d.right-(l*(h.length+1)+_+h.reduce(((t,e)=>t+e),0)),u,r.fullScreen.zIndex+o,_,l,p),n.src=null!==m&&void 0!==m?m:v?"data:image/svg+xml;base64,".concat(btoa(v)):"";return(null!==(e=null===(i=a.canvas.element)||void 0===i?void 0:i.parentNode)&&void 0!==e?e:document.body).append(n),n.addEventListener("click",(()=>{s()})),n}function u(t){t&&t.remove()}class c{constructor(t,e){this._addBuffer=t=>{const e=t.createBufferSource();return this._audioSources.push(e),e},this._addOscillator=t=>{const e=t.createOscillator();return this._audioSources.push(e),e},this._initEvents=()=>{const t=this._container,e=t.actualOptions.sounds;if(null!==e&&void 0!==e&&e.enable&&t.canvas.element)for(const i of e.events){const t=e=>{(async()=>{const s=i.filter&&!i.filter(e);if(this._container!==e.container)return;if(!this._container||this._container.muted||this._container.destroyed)return void(0,n.yW)(i.event,(e=>{this._engine.removeEventListener(e,t)}));if(s)return;if(i.audio)this._playBuffer((0,n.pd)(i.audio));else if(i.melodies){const t=(0,n.Gi)(i.melodies);t.melodies.length?await Promise.allSettled(t.melodies.map((e=>this._playNote(e.notes,0,t.loop)))):await this._playNote(t.notes,0,t.loop)}else if(i.notes){const t=(0,n.Gi)(i.notes);await this._playNote([t],0,!1)}})()};(0,n.yW)(i.event,(e=>{this._engine.addEventListener(e,t)}))}},this._mute=async()=>{const t=this._container,e=this._getAudioContext();for(const i of this._audioSources)this._removeAudioSource(i);this._gain&&this._gain.disconnect(),await e.close(),t.audioContext=void 0,this._engine.dispatchEvent("soundsMuted",{container:this._container})},this._playBuffer=t=>{var e;const i=this._audioMap.get(t.source);if(!i)return;const n=this._container.audioContext;if(!n)return;const s=this._addBuffer(n);s.loop=t.loop,s.buffer=i,s.connect(null!==(e=this._gain)&&void 0!==e?e:n.destination),s.start()},this._playFrequency=async(t,e)=>{if(!this._gain||this._container.muted)return;const i=this._getAudioContext(),n=this._addOscillator(i);return n.connect(this._gain),n.type="sine",n.frequency.value=t,n.start(),new Promise((t=>{setTimeout((()=>{this._removeAudioSource(n),t()}),e)}))},this._playMuteSound=()=>{if(this._container.muted)return;const t=this._getAudioContext(),e=t.createGain();e.connect(t.destination),e.gain.value=0;const i=t.createOscillator();i.connect(e),i.type="sine",i.frequency.value=1,i.start(),setTimeout((()=>{i.stop(),i.disconnect(),e.disconnect()}))},this._playNote=async(t,e,i)=>{if(this._container.muted)return;const s=t[e];if(!s)return;const o=s.value,a=(0,n.yW)(o,(async(i,n)=>this._playNoteValue(t,e,n)));await((0,n.c7)(a)?Promise.allSettled(a):a);let u=e+1;i&&u>=t.length&&(u%=t.length),this._container.muted||await this._playNote(t,u,i)},this._playNoteValue=async(t,e,i)=>{const o=t[e];if(!o)return;const a=(0,n.pd)(o.value,i,!0);try{const t=(0,s.__)(a);if(!(0,n.Ib)(t))return;await this._playFrequency(t,o.duration)}catch(u){(0,n.eL)().error(u)}},this._removeAudioSource=t=>{t.stop(),t.disconnect();this._audioSources.splice(this._audioSources.indexOf(t),1)},this._unmute=()=>{const t=this._container.actualOptions.sounds;if(!t)return;const e=this._getAudioContext();this._audioSources||(this._audioSources=[]);const i=e.createGain();i.connect(e.destination),i.gain.value=t.volume.value/n.sc,this._gain=i,this._initEvents(),this._engine.dispatchEvent("soundsUnmuted",{container:this._container})},this._updateMuteIcons=()=>{const t=this._container,e=t.actualOptions.sounds;if(null===e||void 0===e||!e.enable||!e.icons.enable)return;const i=this._muteImg,n=this._unmuteImg;i&&(i.style.display=t.muted?"block":"none"),n&&(n.style.display=t.muted?"none":"block")},this._updateMuteStatus=async()=>{const t=this._container,e=this._getAudioContext();t.muted?(await(null===e||void 0===e?void 0:e.suspend()),await this._mute()):(await(null===e||void 0===e?void 0:e.resume()),this._unmute(),this._playMuteSound())},this._updateVolume=async()=>{var t;const e=this._container,i=e.actualOptions.sounds;if(null===i||void 0===i||!i.enable)return;(0,n.qk)(this._volume,i.volume.min,i.volume.max);let s=!1;this._volume<=0&&!e.muted?(this._volume=0,e.muted=!0,s=!0):this._volume>0&&e.muted&&(e.muted=!1,s=!0),s&&(this._updateMuteIcons(),await this._updateMuteStatus()),null!==(t=this._gain)&&void 0!==t&&t.gain&&(this._gain.gain.value=this._volume/n.sc)},this._container=t,this._engine=e,this._volume=0,this._audioSources=[],this._audioMap=new Map}async init(){const t=this._container.actualOptions.sounds;if(null===t||void 0===t||!t.enable)return;if(t.autoPlay&&(0,s.q8)()){const t=()=>{removeEventListener(n.UK,t),removeEventListener(n.cK,t),(0,s.uM)(),this.unmute()},e={capture:!0,once:!0};addEventListener(n.UK,t,e),addEventListener(n.cK,t,e)}this._volume=t.volume.value;const e=t.events;this._audioMap=new Map;for(const i of e){if(!i.audio)continue;const t=(0,n.yW)(i.audio,(async t=>{const e=await fetch(t.source);if(!e.ok)return;const i=await e.arrayBuffer(),n=this._getAudioContext(),s=await n.decodeAudioData(i);this._audioMap.set(t.source,s)}));t instanceof Promise?await t:await Promise.allSettled(t)}}async mute(){this._container.muted||await this.toggleMute()}async start(){const t=this._container,e=t.actualOptions,i=e.sounds;if(null===i||void 0===i||!i.enable||!t.canvas.element)return;t.muted=!0;const n=t.canvas.element,o={top:n.offsetTop,right:n.offsetLeft+n.offsetWidth},{mute:u,unmute:c,volumeDown:l,volumeUp:r}=i.icons,d=async()=>{await this.toggleMute()},h=i.icons.enable?"block":"none";this._muteImg=a({container:t,options:e,pos:o,display:h,iconOptions:u,margin:10,rightOffsets:[l.width,r.width],clickCb:d}),this._unmuteImg=a({container:t,options:e,pos:o,display:"none",iconOptions:c,margin:10,rightOffsets:[l.width,r.width],clickCb:d}),this._volumeDownImg=a({container:t,options:e,pos:o,display:h,iconOptions:l,margin:10,rightOffsets:[r.width],clickCb:async()=>{await this.volumeDown()}}),this._volumeUpImg=a({container:t,options:e,pos:o,display:h,iconOptions:r,margin:10,rightOffsets:[],clickCb:async()=>{await this.volumeUp()}}),!(0,s.q8)()&&i.autoPlay&&await this.unmute()}stop(){this._container.muted=!0,(async()=>{await this._mute(),u(this._muteImg),u(this._unmuteImg),u(this._volumeDownImg),u(this._volumeUpImg)})()}async toggleMute(){const t=this._container;t.muted=!t.muted,this._updateMuteIcons(),await this._updateMuteStatus()}async unmute(){this._container.muted&&await this.toggleMute()}async volumeDown(){const t=this._container,e=t.actualOptions.sounds;null!==e&&void 0!==e&&e.enable&&(t.muted&&(this._volume=0),this._volume-=e.volume.step,await this._updateVolume())}async volumeUp(){const t=this._container.actualOptions.sounds;null!==t&&void 0!==t&&t.enable&&(this._volume+=t.volume.step,await this._updateVolume())}_getAudioContext(){const t=this._container;return t.audioContext||(t.audioContext=new AudioContext),t.audioContext}}}}]);
//# sourceMappingURL=4448.8325d405.chunk.js.map